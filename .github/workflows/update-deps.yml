name: "Update dependencies"
on:
  push:
    branches:
      - mj-auto-update-deps

  schedule:
    # Sunday, 1PM UTC
  - cron: "0 13 * * 0"

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Setup Go
      uses: actions/setup-go@v3
      with:
        go-version: "1.19"
    - name: create pull request
      run: |
        git config --global user.email "ExternalSecretsOperator@users.noreply.github.com"
        git config --global user.name "External Secrets Operator"
        BRANCH=update-deps-$(date "+%s")
        touch example.foo
        # make update-deps
        git checkout -b $BRANCH
        git add -A
        git commit -m "update dependencies" -s
        git push origin $BRANCH
        gh pr create -B main -H ${BRANCH}- --title 'chore: update dependencies' --body 'Created by Github action'
      env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
